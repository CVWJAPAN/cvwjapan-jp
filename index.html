<!-- ▼▼ CVWGEN（CVWJAPANデザイン）ここから ▼▼ -->
<div id="chatContainer" style="background:#000;border:2px solid #39ff14;border-radius:16px;padding:20px;max-width:720px;margin:auto;box-shadow:0 0 20px #00ffff;margin-top:30px;color:#fff;">
  <h2 style="color:#ff00ff;">CVWGEN - 子ども支援AI</h2>
  <p style="color:#fff;">あなたの立場を選んでください：</p>
  <select id="modeSelect" style="font-size:16px;padding:6px;margin-bottom:10px;background:#000;color:#39ff14;border:1px solid #39ff14;">
    <option value="child">子どもとして話す</option>
    <option value="parent">保護者として相談する</option>
    <option value="worker">支援者・児童福祉司として使う</option>
  </select>
  <div id="chatBox" style="height:320px;overflow-y:auto;border:1px solid #ff0;background:#111;padding:10px;margin-bottom:15px;color:#fff;"></div>
  <input type="text" id="userInput" placeholder="あなたの言葉を聞かせてください" style="width:70%;padding:10px;font-size:16px;background:#000;color:#fff;border:1px solid #ff0;">
  <button onclick="sendMessage()" style="padding:10px 20px;font-size:16px;background-color:#00ffff;color:#000;border:none;cursor:pointer;">送信</button>
</div>

<script>
  const chatBox = document.getElementById("chatBox");
  const input = document.getElementById("userInput");
  const modeSelect = document.getElementById("modeSelect");

  const systemPrompts = {
    child: "あなたは子どもに寄り添う福祉支援AIです。やさしい言葉で安心できるように対応してください。つらいことには共感し、『いてくれてありがとう』『つらかったね』などの言葉を含めてください。",
    parent: "あなたは保護者を支える福祉AIです。子育ての悩みに対して、児童福祉法に基づき、安心できる支援案内を行ってください。",
    worker: "あなたは児童福祉司や支援者をサポートするAIです。児童福祉法、虐待防止法に沿って、支援記録の提案や通告判断、リスク分類などの助言をしてください。"
  };

  let messageHistory = [];

  async function sendMessage() {
    const text = input.value.trim();
    if (!text) return;

    chatBox.innerHTML += `<p><strong style="color:#ffff00;">あなた：</strong> ${text}</p>`;
    input.value = "";
    chatBox.scrollTop = chatBox.scrollHeight;

    if (messageHistory.length === 0) {
      const mode = modeSelect.value;
      messageHistory.push({ role: "system", content: systemPrompts[mode] });
    }

    messageHistory.push({ role: "user", content: text });

    const response = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_API_KEY"  // ← ここにAPIキーを貼り付け
      },
      body: JSON.stringify({
        model: "gpt-4",
        messages: messageHistory,
        temperature: 0.6
      })
    });

    const data = await response.json();
    const reply = data.choices[0].message.content;
    messageHistory.push({ role: "assistant", content: reply });

    chatBox.innerHTML += `<p><strong style="color:#00ffff;">CVWGEN：</strong> ${reply}</p>`;
    chatBox.scrollTop = chatBox.scrollHeight;
  }
</script>
<!-- ▲▲ CVWGEN（CVWJAPANデザイン）ここまで ▲▲ -->
